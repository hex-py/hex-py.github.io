---
title: Gogs集成LDAP
categories:
  - Devops
tags:
  - Devops
  - LDAP
  - Gogs
date: '2020-01-06 10:52:50'
top: false
comments: true
---

# 重要
> 1. Gogs 支持 本地认证+LDAP认证 模式。
> 2. Gogs 要求LDAP中的DN必须具备`mail`属性。

# 配置

使用安装时配置的管理帐号登陆gogs系统，点击头像进入`管理面板`—>`认证管理源`—>`添加新的源`,根据自己的ldap配置填入即可。
这里就是一个绑定帐号，配置过gitlab的也差不多，也是需要一个帐号来获取ldap 帐号树的信息.

![image](https://tva1.sinaimg.cn/large/006hT4w1ly1gap9ln0n3uj30ri0jkn0e.jpg)
![image](https://tvax3.sinaimg.cn/large/006hT4w1ly1gap9q12dy3j30q70iswgb.jpg)

说明:

非必填项都未做配置
+ *认证名称*: 必填项, 随意填写。
+ *安全协议*: 不加密。
+ *主机地址*: 此处部署k8s中，用的主机名。如果虚拟机部署可以填IP。
+ *主机端口*: ldap服务端口。
+ *绑定DN*: 绑定的dn，此处绑定的admi账号。
+ *绑定密码*: 上面dn的密码。
+ *用户搜索基准*: 从`ou=Product`往下查找匹配用户
+ *用户过滤规则*: dn的属性`objectClass`=`posixAccount` & `uid`=`用户登录输入的用户名`
+ *邮箱属性*: 由于Gogs要求邮箱属性必填，所以ldap创建的用户条目，必须具备mail属性。此处填写mail属性的键名
+ *该授权认证将作为默认登录源*: 勾选该配置。Gogs支持本地认证+ldap认证。比jenkins强太多了。

# Reference
[Gogs 集成 LDAP](https://www.58jb.com/html/gogs-use-ldap-login.html)